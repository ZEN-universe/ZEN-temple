import{s as at,e as h,c as b,b as E,f as _,y as Et,o as g,i as J,h as f,z as Xe,A as Ze,n as $e,B as Dt,C as yt,H as It,t as kt,a as L,d as Ct,g as M,D as xe,j as Vt,E as Tt,r as S,m as oe,v as Ne,w as O,M as et,F as tt}from"../chunks/scheduler.B5o-CLgX.js";import{S as rt,i as dt,b as j,c as be,d as ve,m as me,t as Z,a as ne,e as Ht,f as we,g as Lt}from"../chunks/index.DWyjRG55.js";import{S as Mt,B as St,b as Ot,f as jt}from"../chunks/utils.Bu0rqPKm.js";import{e as ot}from"../chunks/each.D6YF6ztN.js";function nt(e,n,o){const a=e.slice();return a[8]=n[o],a}function lt(e){let n,o=e[8]+"",a,i,m;return{c(){n=h("option"),a=kt(o),i=L(),this.h()},l(c){n=b(c,"OPTION",{});var l=E(n);a=Ct(l,o),i=M(l),l.forEach(_),this.h()},h(){n.__value=m=e[8],xe(n,n.__value)},m(c,l){J(c,n,l),f(n,a),f(n,i)},p(c,l){l&2&&o!==(o=c[8]+"")&&Vt(a,o),l&2&&m!==(m=c[8])&&(n.__value=m,xe(n,n.__value))},d(c){c&&_(n)}}}function zt(e){let n,o,a,i,m,c=ot(e[1]),l=[];for(let s=0;s<c.length;s+=1)l[s]=lt(nt(e,c,s));return{c(){n=h("div"),o=h("select");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){n=b(s,"DIV",{class:!0});var p=E(n);o=b(p,"SELECT",{});var r=E(o);for(let y=0;y<l.length;y+=1)l[y].l(r);r.forEach(_),p.forEach(_),this.h()},h(){o.disabled=a=!e[2],e[0]===void 0&&Et(()=>e[4].call(o)),g(n,"class","dropdown")},m(s,p){J(s,n,p),f(n,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,null);Xe(o,e[0],!0),i||(m=[Ze(o,"change",e[4]),Ze(o,"change",e[5])],i=!0)},p(s,[p]){if(p&2){c=ot(s[1]);let r;for(r=0;r<c.length;r+=1){const y=nt(s,c,r);l[r]?l[r].p(y,p):(l[r]=lt(y),l[r].c(),l[r].m(o,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}p&4&&a!==(a=!s[2])&&(o.disabled=a),p&3&&Xe(o,s[0])},i:$e,o:$e,d(s){s&&_(n),Dt(l,s),i=!1,yt(m)}}}function Bt(e,n,o){let{options:a}=n,{selected_option:i=a[0]}=n,{enabled:m=!0}=n;a.join("_");const c=It();function l(){c("selection-changed",i)}function s(){i=Tt(this),o(0,i),o(1,a)}const p=()=>l();return e.$$set=r=>{"options"in r&&o(1,a=r.options),"selected_option"in r&&o(0,i=r.selected_option),"enabled"in r&&o(2,m=r.enabled)},[i,a,m,l,s,p]}class Re extends rt{constructor(n){super(),dt(this,n,Bt,zt,at,{options:1,selected_option:0,enabled:2})}}function st(e){let n,o='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=h("div"),n.innerHTML=o,this.h()},l(a){n=b(a,"DIV",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-57s7b4"&&(n.innerHTML=o),this.h()},h(){g(n,"class","text-center")},m(a,i){J(a,n,i)},d(a){a&&_(n)}}}function it(e){let n,o,a,i;function m(l){e[24](l)}let c={};return e[10]!==void 0&&(c.config=e[10]),o=new St({props:c}),S.push(()=>j(o,"config",m)),{c(){n=h("div"),be(o.$$.fragment),this.h()},l(l){n=b(l,"DIV",{class:!0});var s=E(n);ve(o.$$.fragment,s),s.forEach(_),this.h()},h(){g(n,"class","svelte-1brc9ml"),et(n,"hidden",e[3]||!e[1])},m(l,s){J(l,n,s),me(o,n,null),i=!0},p(l,s){const p={};!a&&s&1024&&(a=!0,p.config=l[10],O(()=>a=!1)),o.$set(p),(!i||s&10)&&et(n,"hidden",l[3]||!l[1])},i(l){i||(Z(o.$$.fragment,l),i=!0)},o(l){ne(o.$$.fragment,l),i=!1},d(l){l&&_(n),we(o)}}}function Pt(e){let n,o='<div class="col"><h2>The Energy Balance</h2></div>',a,i,m,c,l,s,p,r='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',y,k,T,w,ce,le,fe,ue,_e,pe,F,A,Ee='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',ge,N,H,K,R,u,Q="Year",$,C,he,I,se,U,z,d,x="Node",Le,B,Me,Se,Oe,ie,X,ae,We="Carrier",je,P,ze,Be,De,ee,q,ye,Ie;function ct(t){e[13](t)}function ft(t){e[14](t)}function ut(t){e[15](t)}function _t(t){e[16](t)}function pt(t){e[17](t)}let re={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(re.carriers=e[6]),e[4]!==void 0&&(re.nodes=e[4]),e[8]!==void 0&&(re.years=e[8]),e[0]!==void 0&&(re.selected_solution=e[0]),e[2]!==void 0&&(re.loading=e[2]),w=new Mt({props:re}),S.push(()=>j(w,"carriers",ct)),S.push(()=>j(w,"nodes",ft)),S.push(()=>j(w,"years",ut)),S.push(()=>j(w,"selected_solution",_t)),S.push(()=>j(w,"loading",pt)),w.$on("solution_selected",e[11]);function gt(t){e[18](t)}function ht(t){e[19](t)}let Pe={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(Pe.options=e[8]),e[9]!==void 0&&(Pe.selected_option=e[9]),C=new Re({props:Pe}),S.push(()=>j(C,"options",gt)),S.push(()=>j(C,"selected_option",ht)),C.$on("selection-changed",e[12]);function bt(t){e[20](t)}function vt(t){e[21](t)}let qe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(qe.options=e[4]),e[5]!==void 0&&(qe.selected_option=e[5]),B=new Re({props:qe}),S.push(()=>j(B,"options",bt)),S.push(()=>j(B,"selected_option",vt)),B.$on("selection-changed",e[12]);function mt(t){e[22](t)}function wt(t){e[23](t)}let Fe={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Fe.options=e[6]),e[7]!==void 0&&(Fe.selected_option=e[7]),P=new Re({props:Fe}),S.push(()=>j(P,"options",mt)),S.push(()=>j(P,"selected_option",wt)),P.$on("selection-changed",e[12]);let V=e[3]&&st(),D=!e[3]&&e[1]&&it(e);return{c(){n=h("div"),n.innerHTML=o,a=L(),i=h("div"),m=h("div"),c=h("div"),l=h("div"),s=h("div"),p=h("h2"),p.innerHTML=r,y=L(),k=h("div"),T=h("div"),be(w.$$.fragment),pe=L(),F=h("div"),A=h("h2"),A.innerHTML=Ee,ge=L(),N=h("div"),H=h("div"),K=h("div"),R=h("div"),u=h("h3"),u.textContent=Q,$=L(),be(C.$$.fragment),se=L(),U=h("div"),z=h("div"),d=h("h3"),d.textContent=x,Le=L(),be(B.$$.fragment),Oe=L(),ie=h("div"),X=h("div"),ae=h("h3"),ae.textContent=We,je=L(),be(P.$$.fragment),De=L(),ee=h("div"),q=h("div"),V&&V.c(),ye=L(),D&&D.c(),this.h()},l(t){n=b(t,"DIV",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1d6fcfp"&&(n.innerHTML=o),a=M(t),i=b(t,"DIV",{class:!0});var v=E(i);m=b(v,"DIV",{class:!0});var W=E(m);c=b(W,"DIV",{class:!0,style:!0});var te=E(c);l=b(te,"DIV",{class:!0,id:!0});var G=E(l);s=b(G,"DIV",{class:!0});var Y=E(s);p=b(Y,"H2",{class:!0,"data-svelte-h":!0}),oe(p)!=="svelte-1oln34a"&&(p.innerHTML=r),y=M(Y),k=b(Y,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ae=E(k);T=b(Ae,"DIV",{class:!0});var Ge=E(T);ve(w.$$.fragment,Ge),Ge.forEach(_),Ae.forEach(_),Y.forEach(_),pe=M(G),F=b(G,"DIV",{class:!0});var ke=E(F);A=b(ke,"H2",{class:!0,"data-svelte-h":!0}),oe(A)!=="svelte-1huxmzt"&&(A.innerHTML=Ee),ge=M(ke),N=b(ke,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ye=E(N);H=b(Ye,"DIV",{class:!0});var de=E(H);K=b(de,"DIV",{class:!0});var Je=E(K);R=b(Je,"DIV",{class:!0});var Ce=E(R);u=b(Ce,"H3",{"data-svelte-h":!0}),oe(u)!=="svelte-r9e7qt"&&(u.textContent=Q),$=M(Ce),ve(C.$$.fragment,Ce),Ce.forEach(_),Je.forEach(_),se=M(de),U=b(de,"DIV",{class:!0});var Ke=E(U);z=b(Ke,"DIV",{class:!0});var Ve=E(z);d=b(Ve,"H3",{"data-svelte-h":!0}),oe(d)!=="svelte-ocjo5w"&&(d.textContent=x),Le=M(Ve),ve(B.$$.fragment,Ve),Ve.forEach(_),Ke.forEach(_),Oe=M(de),ie=b(de,"DIV",{class:!0});var Qe=E(ie);X=b(Qe,"DIV",{class:!0});var Te=E(X);ae=b(Te,"H3",{"data-svelte-h":!0}),oe(ae)!=="svelte-xc22hm"&&(ae.textContent=We),je=M(Te),ve(P.$$.fragment,Te),Te.forEach(_),Qe.forEach(_),de.forEach(_),Ye.forEach(_),ke.forEach(_),G.forEach(_),te.forEach(_),W.forEach(_),v.forEach(_),De=M(t),ee=b(t,"DIV",{class:!0});var Ue=E(ee);q=b(Ue,"DIV",{class:!0,style:!0});var He=E(q);V&&V.l(He),ye=M(He),D&&D.l(He),He.forEach(_),Ue.forEach(_),this.h()},h(){g(n,"class","row"),g(p,"class","accordion-header"),g(T,"class","accordion-body"),g(k,"id","collapseOne"),g(k,"class","accordion-collapse collapse show"),g(k,"data-bs-parent","#accordionExample"),g(s,"class","accordion-item solution-selection"),g(A,"class","accordion-header"),g(R,"class","col-6"),g(K,"class","row"),g(z,"class","col-6"),g(U,"class","row"),g(X,"class","col-6"),g(ie,"class","row"),g(H,"class","accordion-body"),g(N,"id","collapseTwo"),g(N,"class","accordion-collapse collapse"),g(N,"data-bs-parent","#accordionExample"),g(F,"class","accordion-item"),g(l,"class","accordion"),g(l,"id","accordionExample"),g(c,"class","filters"),Ne(c,"position","absolute"),Ne(c,"width","100%"),g(m,"class","col position-relative"),g(i,"class","row"),g(q,"class","col"),Ne(q,"margin-top","400px"),g(ee,"class","row")},m(t,v){J(t,n,v),J(t,a,v),J(t,i,v),f(i,m),f(m,c),f(c,l),f(l,s),f(s,p),f(s,y),f(s,k),f(k,T),me(w,T,null),f(l,pe),f(l,F),f(F,A),f(F,ge),f(F,N),f(N,H),f(H,K),f(K,R),f(R,u),f(R,$),me(C,R,null),f(H,se),f(H,U),f(U,z),f(z,d),f(z,Le),me(B,z,null),f(H,Oe),f(H,ie),f(ie,X),f(X,ae),f(X,je),me(P,X,null),J(t,De,v),J(t,ee,v),f(ee,q),V&&V.m(q,null),f(q,ye),D&&D.m(q,null),Ie=!0},p(t,[v]){const W={};v&12&&(W.enabled=!t[2]&&!t[3]),!ce&&v&64&&(ce=!0,W.carriers=t[6],O(()=>ce=!1)),!le&&v&16&&(le=!0,W.nodes=t[4],O(()=>le=!1)),!fe&&v&256&&(fe=!0,W.years=t[8],O(()=>fe=!1)),!ue&&v&1&&(ue=!0,W.selected_solution=t[0],O(()=>ue=!1)),!_e&&v&4&&(_e=!0,W.loading=t[2],O(()=>_e=!1)),w.$set(W);const te={};v&12&&(te.enabled=!t[3]&&!t[2]),!he&&v&256&&(he=!0,te.options=t[8],O(()=>he=!1)),!I&&v&512&&(I=!0,te.selected_option=t[9],O(()=>I=!1)),C.$set(te);const G={};v&12&&(G.enabled=!t[3]&&!t[2]),!Me&&v&16&&(Me=!0,G.options=t[4],O(()=>Me=!1)),!Se&&v&32&&(Se=!0,G.selected_option=t[5],O(()=>Se=!1)),B.$set(G);const Y={};v&12&&(Y.enabled=!t[3]&&!t[2]),!ze&&v&64&&(ze=!0,Y.options=t[6],O(()=>ze=!1)),!Be&&v&128&&(Be=!0,Y.selected_option=t[7],O(()=>Be=!1)),P.$set(Y),t[3]?V||(V=st(),V.c(),V.m(q,ye)):V&&(V.d(1),V=null),!t[3]&&t[1]?D?(D.p(t,v),v&10&&Z(D,1)):(D=it(t),D.c(),Z(D,1),D.m(q,null)):D&&(Lt(),ne(D,1,1,()=>{D=null}),Ht())},i(t){Ie||(Z(w.$$.fragment,t),Z(C.$$.fragment,t),Z(B.$$.fragment,t),Z(P.$$.fragment,t),Z(D),Ie=!0)},o(t){ne(w.$$.fragment,t),ne(C.$$.fragment,t),ne(B.$$.fragment,t),ne(P.$$.fragment,t),ne(D),Ie=!1},d(t){t&&(_(n),_(a),_(i),_(De),_(ee)),we(w),we(C),we(B),we(P),V&&V.d(),D&&D.d()}}}function qt(e,n,o){var a=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let i=null,m=!1,c=!1,l=!1,s=[],p=null,r=[],y=null,k=[],T=null,w={type:"bar",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,mode:"x"},zoom:{wheel:{enabled:!0},mode:"x"}}}}};async function ce(){i&&(o(5,p=s[0]),o(7,y=r[0]),o(9,T=k[0]),o(1,m=!1),await le())}async function le(){if(o(3,l=!0),tt(),p==null||y==null||T==null||i==null){o(3,l=!1);return}let u=Math.floor((T-i.detail.system.reference_year)/i.detail.system.interval_between_years);console.log("Getting energy balance.");let Q=await Ot(i.solution_name,p,y,i.scenario_name,u);console.log("Received.");let $=[],C=0;for(const I in Q){let se={node:[p]};if(Q[I]==null)continue;if("technology"in Q[I].data[0]){let d=[];for(const x of Q[I].data)d.push(x.technology);se={technology:d}}let U={},z=jt(Q[I].data,se,U);if(z.length!=0)for(let d of z){I=="flow_storage_discharge"&&(d.label=d.label+" (discharge)"),I=="flow_transport_in"&&(d.label=d.label+" (transport in)"),I=="flow_import"&&(d.label="Import"),I=="shed_demand"&&(d.label="Shed Demand"),I=="flow_storage_charge"&&(d.label=d.label+" (charge)"),I=="flow_transport_out"&&(d.label=d.label+" (transport out)"),I=="flow_export"&&(d.label="Export");let x="line";Object.keys(d.data).length==1&&(x="bar"),I=="demand"?(d.label="Demand",d.type="line",d.stack="ownCustomStack",d.fill=!1,d.borderColor="black",d.backgroundColor="white",d.borderWidth=2,Object.keys(d.data).length==1&&(d.pointRadius=2)):(d.type=x,d.fill="origin",d.borderColor=a[C%a.length],d.backgroundColor=a[C%a.length].replace(")",", 0.8)")),$.push(d),C++}}o(10,w.data.labels=Object.keys($[0].data),w),o(10,w.data.datasets=$,w),console.log(w),o(3,l=!1),o(1,m=!0);let he=performance.now();await tt(),console.log("Building plot took",performance.now()-he),console.log("Done.")}function fe(u){r=u,o(6,r)}function ue(u){s=u,o(4,s)}function _e(u){k=u,o(8,k)}function pe(u){i=u,o(0,i)}function F(u){c=u,o(2,c)}function A(u){k=u,o(8,k)}function Ee(u){T=u,o(9,T)}function ge(u){s=u,o(4,s)}function N(u){p=u,o(5,p)}function H(u){r=u,o(6,r)}function K(u){y=u,o(7,y)}function R(u){w=u,o(10,w)}return[i,m,c,l,s,p,r,y,k,T,w,ce,le,fe,ue,_e,pe,F,A,Ee,ge,N,H,K,R]}class At extends rt{constructor(n){super(),dt(this,n,qt,Pt,at,{})}}export{At as component};
