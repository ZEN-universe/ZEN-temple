import{s as ct,e as g,c as h,b as w,f as u,y as Ct,o as p,i as Z,h as d,z as et,A as tt,n as ot,B as Vt,C as kt,G as Tt,t as Ht,a as S,d as Lt,g as O,D as nt,j as Mt,E as St,r as H,m as te,v as We,K as lt,w as L,F as st}from"../chunks/scheduler.BXxlKFsS.js";import{S as ft,i as _t,b as M,c as ve,d as me,m as we,t as Ee,a as De,f as ye}from"../chunks/index.ElVQI2Jj.js";import{S as Ot,B as jt,b as Bt,f as Pt}from"../chunks/utils.BGVeK_Qy.js";import{e as it}from"../chunks/each.D6YF6ztN.js";function at(t,n,o){const r=t.slice();return r[8]=n[o],r}function rt(t){let n,o=t[8]+"",r,c,E;return{c(){n=g("option"),r=Ht(o),c=S(),this.h()},l(_){n=h(_,"OPTION",{});var l=w(n);r=Lt(l,o),c=O(l),l.forEach(u),this.h()},h(){n.__value=E=t[8],nt(n,n.__value)},m(_,l){Z(_,n,l),d(n,r),d(n,c)},p(_,l){l&2&&o!==(o=_[8]+"")&&Mt(r,o),l&2&&E!==(E=_[8])&&(n.__value=E,nt(n,n.__value))},d(_){_&&u(n)}}}function zt(t){let n,o,r,c,E,_=it(t[1]),l=[];for(let s=0;s<_.length;s+=1)l[s]=rt(at(t,_,s));return{c(){n=g("div"),o=g("select");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){n=h(s,"DIV",{class:!0});var b=w(n);o=h(b,"SELECT",{});var i=w(o);for(let D=0;D<l.length;D+=1)l[D].l(i);i.forEach(u),b.forEach(u),this.h()},h(){o.disabled=r=!t[2],t[0]===void 0&&Ct(()=>t[4].call(o)),p(n,"class","dropdown")},m(s,b){Z(s,n,b),d(n,o);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,null);et(o,t[0],!0),c||(E=[tt(o,"change",t[4]),tt(o,"change",t[5])],c=!0)},p(s,[b]){if(b&2){_=it(s[1]);let i;for(i=0;i<_.length;i+=1){const D=at(s,_,i);l[i]?l[i].p(D,b):(l[i]=rt(D),l[i].c(),l[i].m(o,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=_.length}b&4&&r!==(r=!s[2])&&(o.disabled=r),b&3&&et(o,s[0])},i:ot,o:ot,d(s){s&&u(n),Vt(l,s),c=!1,kt(E)}}}function qt(t,n,o){let{options:r}=n,{selected_option:c=r[0]}=n,{enabled:E=!0}=n;r.join("_");const _=Tt();function l(){_("selection-changed",c)}function s(){c=St(this),o(0,c),o(1,r)}const b=()=>l();return t.$$set=i=>{"options"in i&&o(1,r=i.options),"selected_option"in i&&o(0,c=i.selected_option),"enabled"in i&&o(2,E=i.enabled)},[c,r,E,l,s,b]}class Ae extends ft{constructor(n){super(),_t(this,n,qt,zt,ct,{options:1,selected_option:0,enabled:2})}}function dt(t){let n,o='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=g("div"),n.innerHTML=o,this.h()},l(r){n=h(r,"DIV",{class:!0,"data-svelte-h":!0}),te(n)!=="svelte-57s7b4"&&(n.innerHTML=o),this.h()},h(){p(n,"class","text-center")},m(r,c){Z(r,n,c)},d(r){r&&u(n)}}}function Ft(t){let n,o='<div class="col"><h2>The Energy Balance</h2></div>',r,c,E,_,l,s,b,i='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',D,I,k,m,de,oe,ce,fe,_e,ue,z,R,Ie='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',pe,q,T,Y,F,f,J="Year",ne,C,ge,y,le,Q,j,a,$="Node",Se,B,Oe,je,Be,se,U,ie,Ke="Carrier",Pe,P,ze,qe,Ce,x,G,Ve,X,W,Fe,he;function ut(e){t[13](e)}function pt(e){t[14](e)}function gt(e){t[15](e)}function ht(e){t[16](e)}function bt(e){t[17](e)}let ae={enabled:!t[2]&&!t[3]};t[6]!==void 0&&(ae.carriers=t[6]),t[4]!==void 0&&(ae.nodes=t[4]),t[8]!==void 0&&(ae.years=t[8]),t[0]!==void 0&&(ae.selected_solution=t[0]),t[2]!==void 0&&(ae.loading=t[2]),m=new Ot({props:ae}),H.push(()=>M(m,"carriers",ut)),H.push(()=>M(m,"nodes",pt)),H.push(()=>M(m,"years",gt)),H.push(()=>M(m,"selected_solution",ht)),H.push(()=>M(m,"loading",bt)),m.$on("solution_selected",t[11]);function vt(e){t[18](e)}function mt(e){t[19](e)}let Ge={enabled:!t[3]&&!t[2]};t[8]!==void 0&&(Ge.options=t[8]),t[9]!==void 0&&(Ge.selected_option=t[9]),C=new Ae({props:Ge}),H.push(()=>M(C,"options",vt)),H.push(()=>M(C,"selected_option",mt)),C.$on("selection-changed",t[12]);function wt(e){t[20](e)}function Et(e){t[21](e)}let Ne={enabled:!t[3]&&!t[2]};t[4]!==void 0&&(Ne.options=t[4]),t[5]!==void 0&&(Ne.selected_option=t[5]),B=new Ae({props:Ne}),H.push(()=>M(B,"options",wt)),H.push(()=>M(B,"selected_option",Et)),B.$on("selection-changed",t[12]);function Dt(e){t[22](e)}function yt(e){t[23](e)}let Re={enabled:!t[3]&&!t[2]};t[6]!==void 0&&(Re.options=t[6]),t[7]!==void 0&&(Re.selected_option=t[7]),P=new Ae({props:Re}),H.push(()=>M(P,"options",Dt)),H.push(()=>M(P,"selected_option",yt)),P.$on("selection-changed",t[12]);let V=t[3]&&dt();function It(e){t[24](e)}let Ye={};return t[10]!==void 0&&(Ye.config=t[10]),W=new jt({props:Ye}),H.push(()=>M(W,"config",It)),{c(){n=g("div"),n.innerHTML=o,r=S(),c=g("div"),E=g("div"),_=g("div"),l=g("div"),s=g("div"),b=g("h2"),b.innerHTML=i,D=S(),I=g("div"),k=g("div"),ve(m.$$.fragment),ue=S(),z=g("div"),R=g("h2"),R.innerHTML=Ie,pe=S(),q=g("div"),T=g("div"),Y=g("div"),F=g("div"),f=g("h3"),f.textContent=J,ne=S(),ve(C.$$.fragment),le=S(),Q=g("div"),j=g("div"),a=g("h3"),a.textContent=$,Se=S(),ve(B.$$.fragment),Be=S(),se=g("div"),U=g("div"),ie=g("h3"),ie.textContent=Ke,Pe=S(),ve(P.$$.fragment),Ce=S(),x=g("div"),G=g("div"),V&&V.c(),Ve=S(),X=g("div"),ve(W.$$.fragment),this.h()},l(e){n=h(e,"DIV",{class:!0,"data-svelte-h":!0}),te(n)!=="svelte-1d6fcfp"&&(n.innerHTML=o),r=O(e),c=h(e,"DIV",{class:!0});var v=w(c);E=h(v,"DIV",{class:!0});var N=w(E);_=h(N,"DIV",{class:!0,style:!0});var ee=w(_);l=h(ee,"DIV",{class:!0,id:!0});var A=w(l);s=h(A,"DIV",{class:!0});var K=w(s);b=h(K,"H2",{class:!0,"data-svelte-h":!0}),te(b)!=="svelte-1oln34a"&&(b.innerHTML=i),D=O(K),I=h(K,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var be=w(I);k=h(be,"DIV",{class:!0});var Je=w(k);me(m.$$.fragment,Je),Je.forEach(u),be.forEach(u),K.forEach(u),ue=O(A),z=h(A,"DIV",{class:!0});var ke=w(z);R=h(ke,"H2",{class:!0,"data-svelte-h":!0}),te(R)!=="svelte-1huxmzt"&&(R.innerHTML=Ie),pe=O(ke),q=h(ke,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Qe=w(q);T=h(Qe,"DIV",{class:!0});var re=w(T);Y=h(re,"DIV",{class:!0});var Ue=w(Y);F=h(Ue,"DIV",{class:!0});var Te=w(F);f=h(Te,"H3",{"data-svelte-h":!0}),te(f)!=="svelte-r9e7qt"&&(f.textContent=J),ne=O(Te),me(C.$$.fragment,Te),Te.forEach(u),Ue.forEach(u),le=O(re),Q=h(re,"DIV",{class:!0});var Xe=w(Q);j=h(Xe,"DIV",{class:!0});var He=w(j);a=h(He,"H3",{"data-svelte-h":!0}),te(a)!=="svelte-ocjo5w"&&(a.textContent=$),Se=O(He),me(B.$$.fragment,He),He.forEach(u),Xe.forEach(u),Be=O(re),se=h(re,"DIV",{class:!0});var Ze=w(se);U=h(Ze,"DIV",{class:!0});var Le=w(U);ie=h(Le,"H3",{"data-svelte-h":!0}),te(ie)!=="svelte-xc22hm"&&(ie.textContent=Ke),Pe=O(Le),me(P.$$.fragment,Le),Le.forEach(u),Ze.forEach(u),re.forEach(u),Qe.forEach(u),ke.forEach(u),A.forEach(u),ee.forEach(u),N.forEach(u),v.forEach(u),Ce=O(e),x=h(e,"DIV",{class:!0});var $e=w(x);G=h($e,"DIV",{class:!0,style:!0});var Me=w(G);V&&V.l(Me),Ve=O(Me),X=h(Me,"DIV",{class:!0});var xe=w(X);me(W.$$.fragment,xe),xe.forEach(u),Me.forEach(u),$e.forEach(u),this.h()},h(){p(n,"class","row"),p(b,"class","accordion-header"),p(k,"class","accordion-body"),p(I,"id","collapseOne"),p(I,"class","accordion-collapse collapse show"),p(I,"data-bs-parent","#accordionExample"),p(s,"class","accordion-item solution-selection"),p(R,"class","accordion-header"),p(F,"class","col-6"),p(Y,"class","row"),p(j,"class","col-6"),p(Q,"class","row"),p(U,"class","col-6"),p(se,"class","row"),p(T,"class","accordion-body"),p(q,"id","collapseTwo"),p(q,"class","accordion-collapse collapse"),p(q,"data-bs-parent","#accordionExample"),p(z,"class","accordion-item"),p(l,"class","accordion"),p(l,"id","accordionExample"),p(_,"class","filters"),We(_,"position","absolute"),We(_,"width","100%"),p(E,"class","col position-relative"),p(c,"class","row"),p(X,"class","svelte-1brc9ml"),lt(X,"hidden",t[3]||!t[1]),p(G,"class","col"),We(G,"margin-top","400px"),p(x,"class","row")},m(e,v){Z(e,n,v),Z(e,r,v),Z(e,c,v),d(c,E),d(E,_),d(_,l),d(l,s),d(s,b),d(s,D),d(s,I),d(I,k),we(m,k,null),d(l,ue),d(l,z),d(z,R),d(z,pe),d(z,q),d(q,T),d(T,Y),d(Y,F),d(F,f),d(F,ne),we(C,F,null),d(T,le),d(T,Q),d(Q,j),d(j,a),d(j,Se),we(B,j,null),d(T,Be),d(T,se),d(se,U),d(U,ie),d(U,Pe),we(P,U,null),Z(e,Ce,v),Z(e,x,v),d(x,G),V&&V.m(G,null),d(G,Ve),d(G,X),we(W,X,null),he=!0},p(e,[v]){const N={};v&12&&(N.enabled=!e[2]&&!e[3]),!de&&v&64&&(de=!0,N.carriers=e[6],L(()=>de=!1)),!oe&&v&16&&(oe=!0,N.nodes=e[4],L(()=>oe=!1)),!ce&&v&256&&(ce=!0,N.years=e[8],L(()=>ce=!1)),!fe&&v&1&&(fe=!0,N.selected_solution=e[0],L(()=>fe=!1)),!_e&&v&4&&(_e=!0,N.loading=e[2],L(()=>_e=!1)),m.$set(N);const ee={};v&12&&(ee.enabled=!e[3]&&!e[2]),!ge&&v&256&&(ge=!0,ee.options=e[8],L(()=>ge=!1)),!y&&v&512&&(y=!0,ee.selected_option=e[9],L(()=>y=!1)),C.$set(ee);const A={};v&12&&(A.enabled=!e[3]&&!e[2]),!Oe&&v&16&&(Oe=!0,A.options=e[4],L(()=>Oe=!1)),!je&&v&32&&(je=!0,A.selected_option=e[5],L(()=>je=!1)),B.$set(A);const K={};v&12&&(K.enabled=!e[3]&&!e[2]),!ze&&v&64&&(ze=!0,K.options=e[6],L(()=>ze=!1)),!qe&&v&128&&(qe=!0,K.selected_option=e[7],L(()=>qe=!1)),P.$set(K),e[3]?V||(V=dt(),V.c(),V.m(G,Ve)):V&&(V.d(1),V=null);const be={};!Fe&&v&1024&&(Fe=!0,be.config=e[10],L(()=>Fe=!1)),W.$set(be),(!he||v&10)&&lt(X,"hidden",e[3]||!e[1])},i(e){he||(Ee(m.$$.fragment,e),Ee(C.$$.fragment,e),Ee(B.$$.fragment,e),Ee(P.$$.fragment,e),Ee(W.$$.fragment,e),he=!0)},o(e){De(m.$$.fragment,e),De(C.$$.fragment,e),De(B.$$.fragment,e),De(P.$$.fragment,e),De(W.$$.fragment,e),he=!1},d(e){e&&(u(n),u(r),u(c),u(Ce),u(x)),ye(m),ye(C),ye(B),ye(P),V&&V.d(),ye(W)}}}function Gt(t,n,o){var r=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let c=null,E=!1,_=!1,l=!1,s=[],b=null,i=[],D=null,I=[],k=null,m={type:"bar",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1}};async function de(){c&&(o(5,b=s[0]),o(7,D=i[0]),o(9,k=I[0]),o(1,E=!1),await oe())}async function oe(){if(o(3,l=!0),st(),b==null||D==null||k==null||c==null){o(3,l=!1);return}let f=Math.floor((k-c.detail.system.reference_year)/c.detail.system.interval_between_years);console.log("Getting energy balance.");let J=await Bt(c.solution_name,b,D,c.scenario_name,f);console.log("Received.");let ne=[];o(10,m.data.labels=[],m);let C=0;for(const y in J){let le={node:[b]};if(J[y]==null)continue;if("technology"in J[y].data[0]){let a=[];for(const $ of J[y].data)a.push($.technology);le={technology:a}}let Q={},j=Pt(J[y].data,le,Q);if(j.length!=0)for(let a of j){y=="flow_storage_discharge"&&(a.label=a.label+" (discharge)"),y=="flow_transport_in"&&(a.label=a.label+" (transport in)"),y=="flow_import"&&(a.label="Import"),y=="shed_demand"&&(a.label="Shed Demand"),y=="flow_storage_charge"&&(a.label=a.label+" (charge)"),y=="flow_transport_out"&&(a.label=a.label+" (transport out)"),y=="flow_export"&&(a.label="Export");let $="line";Object.keys(a.data).length==1&&($="bar"),y=="demand"?(a.label="Demand",a.type="line",a.stack="ownCustomStack",a.fill=!1,a.borderColor="black",a.backgroundColor="white",a.borderWidth=2,Object.keys(a.data).length==1&&(a.pointRadius=2)):(a.type=$,a.fill="origin",a.borderColor=r[C%r.length],a.backgroundColor=r[C%r.length].replace(")",", 0.8)")),ne.push(a),C++}}o(10,m.data.datasets=ne,m),o(3,l=!1),o(1,E=!0);let ge=performance.now();await st(),console.log("Building plot took",performance.now()-ge),console.log("Done.")}function ce(f){i=f,o(6,i)}function fe(f){s=f,o(4,s)}function _e(f){I=f,o(8,I)}function ue(f){c=f,o(0,c)}function z(f){_=f,o(2,_)}function R(f){I=f,o(8,I)}function Ie(f){k=f,o(9,k)}function pe(f){s=f,o(4,s)}function q(f){b=f,o(5,b)}function T(f){i=f,o(6,i)}function Y(f){D=f,o(7,D)}function F(f){m=f,o(10,m)}return[c,E,_,l,s,b,i,D,I,k,m,de,oe,ce,fe,_e,ue,z,R,Ie,pe,q,T,Y,F]}class Kt extends ft{constructor(n){super(),_t(this,n,Gt,Ft,ct,{})}}export{Kt as component};
